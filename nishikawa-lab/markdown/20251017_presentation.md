---
marp: true
title: "CNN - aohon; chapter 5.9, 5.10"
paginate: false 
theme: arxiv_plain
---


教科書
5.9, 5.10章(p108-p123)

---



## 画像生成・補完に向けた拡大CNNの導入
ここまでは「変わらない/ダウンサンプリング」を扱ったが、画像を生成・補完する場合はサイズを拡大するCNNが必要。

- 空間方向のサイズとは: width × height（画像サイズ）
- タスク例:
  - コンパクトなベクトルから画像を生成（1×1×K → 2×2×(K/2) → … → W×H×1）
  - セグメンテーション（W×H×1 → … → 1×1×K → … → W×H×1）

> 図提案: エンコーダ（縮小）→ボトルネック→デコーダ（拡大）の全体ブロック図

---

## アップサンプリング＋補完＋畳み込みの基本
サイズ拡大の最も単純な方法は、アップサンプリングと補完を「ペア」で使い、その後に畳み込みを行う。

1. 画素値 x_{ij} を r 画素間隔でとびとびに再配置（アップサンプリング）
2. 間の画素を補完（この時点で画像が r 倍）
3. 畳み込み（フィルタは学習対象）

> 補完手法比較: 最近傍/双一次/双三次でのアーティファクトの違いを短評

---

## 転置畳み込み（アップコンボリューション/サブピクセル）
アップサンプリングと畳み込みをペアにせず、補完を不要とするやり方が「転置畳み込み」。

- 形式的には、通常の畳み込みが $u = W x$ なら $x = W^T u$ と表現可能
- 通常の畳み込みで表現し直せ、入力 $r$ 倍のアップサンプリング（補完なし）後の畳み込みに相当
- 別名: アップコンボリューション/サブピクセル畳み込み
- フィルタサイズは $r$ の整数倍が望ましい（ピクセルシャッフル活用）
- 補完を併用する場合は $r$ の倍数条件は不要

> 図提案: ピクセルシャッフルのチャネル→空間再配置のイラスト

---

## stride と zero-insertion の1次元例
通常の畳み込み（stride=2）はピクセルを「間引く」。

- 入力: [1, 2, 3, 4], フィルタ: [1, 1], stride=2 → 出力: [3, 7]

転置畳み込み（stride=2）はピクセル間に「0」を挿入（zero-insertion）。

- 入力: [3, 7]
- stride=2 で拡大: [3, 0, 7, 0]
- フィルタ [1, 1] で畳み込み: [3, 3, 7, 7]

結果: 入力より大きい配列が得られ、空間的に拡大される。

> 注意: カーネル・パディング選択によりチェッカーボードアーティファクトが発生し得る（回避策の言及）

---

## 拡大畳み込みと「縮小→拡大」の等価性
「ダウンサンプリング→畳み込み→アップサンプリング」は、条件下で「1 回の拡大畳み込み」で置換可能。

- 手順A: 入力 x をダウンサンプリング (1/r) → フィルタ h を畳み込み → アップサンプリング (r)
- 手順B: 倍率 r の拡大畳み込みを適用 → 必要ならダウンサンプリング (1/r)
- 結果が一致（適切なフィルタ設計・境界条件の下）
- 後者は補完をしない分、高い解像度を保持しやすい

> 図提案: 信号処理的なブロック図で A と B の対応関係を併記

---

## U-Net による解像度回復
CNN で一度縮小した後、失われた空間解像度を後半で取り戻すのは難しい。これに対応したのが U-Net。

- 折り返し点で対称な層同士の出力を転送（スキップ接続）
- 転送された層出力を受け側の層入力とチャネル方向に統合
- ResNet の残差接続に似るが、合流時の計算方法が異なる

> 具体例提案: `concat([encoder_feature, decoder_feature], axis=channels)` の図示（チャネル方向の結合）

---

## シフト＆スティッチ（補足）
シフト＆スティッチも存在するが、効率が悪く実用性は低い。

> 備考: 実験比較として 1 スライドだけ触れるか、付録扱いにする選択肢

---

## 物体カテゴリ認識の適用例
### ImageNet 
計約 100 万枚の画像。

- 学習・評価の標準ベンチマーク
- 画像生成/補完系ではなく分類系だが、特徴抽出の理解に有用

> 図提案: クラス分布の概観や典型画像を 3×3 グリッドで

---

## AlexNet と層出力の可視化
教科書には AlexNet を用いた各層の出力やテスト結果が掲載されている。

- 低層: エッジ/テクスチャ、中層: パーツ、高層: カテゴリ概念
- 中間層の活性マップや誤分類例の提示で理解を補助

> 提案: 教科書図を引用（出典明記）し、層ごとの可視化を 2〜3 枚に分割


